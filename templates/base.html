<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>{% block title %}JobAI{% endblock %}</title>

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">

  <style>
    :root {
      --bg-main: #0f172a;
      --bg-card: #020617;
      --border-soft: #1e293b;
      --primary: #6366f1;
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --danger: #f87171;
    }

    body.dark {
      background: var(--bg-main);
      color: var(--text-main);
      font-family: 'Inter', sans-serif;
    }

    /* ===== SIDEBAR LABEL ===== */
    .nav-section-label {
      font-size: 11px;
      letter-spacing: 1px;
      text-transform: uppercase;
      color: var(--text-muted);
      margin: 18px 0 8px;
      padding-left: 14px;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 14px;
      border-radius: 10px;
      color: var(--text-main);
      text-decoration: none;
      font-weight: 500;
      transition: 0.2s ease;
    }

    .nav-item:hover {
      background: rgba(99,102,241,0.12);
    }

    .nav-item.active {
      background: rgba(99,102,241,0.2);
      color: #fff;
    }

    .nav-item.disabled {
      opacity: 0.4;
      pointer-events: none;
    }

    .nav-item.logout {
      color: var(--danger);
      margin-top: 6px;
    }

    /* ===== SIDEBAR ===== */
    .sidebar {
      width: 260px;
      background: var(--bg-card);
      border-right: 1px solid var(--border-soft);
    }

    .brand {
      font-weight: 700;
      font-size: 18px;
      padding: 18px;
      cursor: pointer;
      color: #fff;
    }

    /* ===== MAIN ===== */
    .main {
      padding: 32px;
    }

    /* ===== MOBILE HEADER ===== */
    .mobile-header {
      display: none;
      align-items: center;
      justify-content: space-between;
      padding: 14px 18px;
      background: var(--bg-card);
      border-bottom: 1px solid var(--border-soft);
      position: sticky;
      top: 0;
      z-index: 900;
    }

    .menu-btn {
      font-size: 22px;
      cursor: pointer;
    }

    /* ===== OVERLAY ===== */
    .sidebar-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.55);
      z-index: 900;
    }

    .sidebar-overlay.show {
      display: block;
    }

    /* ===== MOBILE ===== */
    @media (max-width: 900px) {
      .sidebar {
        position: fixed;
        left: -260px;
        top: 0;
        height: 100vh;
        z-index: 1000;
        transition: left 0.3s ease;
      }

      .sidebar.open {
        left: 0;
      }

      .mobile-header {
        display: flex;
      }

      .main {
        padding: 20px;
      }
    }
  </style>
</head>

<body class="dark">

<!-- ===== MOBILE HEADER ===== -->
<div class="mobile-header">
  <div class="menu-btn" onclick="toggleSidebar()">â˜°</div>
  <div class="brand">JobAI</div>
</div>

<!-- ===== OVERLAY ===== -->
<div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

<div class="app">

  <!-- ===== SIDEBAR ===== -->
  <aside class="sidebar" id="sidebar">
    <div class="brand" onclick="navigateAndClose('{{ url_for('dashboard') }}')">
      JobAI
    </div>

    <nav class="nav">

      <a href="{{ url_for('index') }}"
         onclick="closeSidebar()"
         class="nav-item {% if request.path == '/' %}active{% endif %}">
        Home
      </a>

      {% if session.get("user") %}

        <div class="nav-section-label">Core</div>

        <a href="{{ url_for('dashboard') }}"
           onclick="closeSidebar()"
           class="nav-item {% if request.path.startswith('/dashboard') %}active{% endif %}">
          Dashboard
        </a>

        <div class="nav-section-label">Insights</div>

        {% if session.get("prediction_done") %}

          <a href="{{ url_for('analytics') }}"
             onclick="closeSidebar()"
             class="nav-item {% if request.path.startswith('/analytics') %}active{% endif %}">
            Analytics
          </a>

          <a href="{{ url_for('skill_gap') }}"
             onclick="closeSidebar()"
             class="nav-item {% if request.path.startswith('/skill-gap') %}active{% endif %}">
            Skill Gap
          </a>

          <a href="{{ url_for('history') }}"
             onclick="closeSidebar()"
             class="nav-item {% if request.path.startswith('/history') %}active{% endif %}">
            History
          </a>

          <a href="{{ url_for('chatbot') }}"
             onclick="closeSidebar()"
             class="nav-item {% if request.path.startswith('/chatbot') %}active{% endif %}">
            AI Assistant
          </a>

        {% else %}
          <span class="nav-item disabled">Analytics ðŸ”’</span>
          <span class="nav-item disabled">Skill Gap ðŸ”’</span>
          <span class="nav-item disabled">History ðŸ”’</span>
          <span class="nav-item disabled">AI Assistant ðŸ”’</span>
        {% endif %}

        <div class="nav-section-label">Account</div>

        <a href="{{ url_for('logout') }}"
           onclick="closeSidebar()"
           class="nav-item logout">
          Logout
        </a>

      {% endif %}
    </nav>
  </aside>

  <!-- ===== MAIN ===== -->
  <main class="main">
    {% block content %}{% endblock %}
  </main>

</div>

<script>
const sidebar = document.getElementById("sidebar");
const overlay = document.getElementById("sidebarOverlay");

function toggleSidebar() {
  sidebar.classList.toggle("open");
  overlay.classList.toggle("show");
  document.body.style.overflow =
    sidebar.classList.contains("open") ? "hidden" : "";
}

function closeSidebar() {
  sidebar.classList.remove("open");
  overlay.classList.remove("show");
  document.body.style.overflow = "";
}

function navigateAndClose(url) {
  closeSidebar();
  window.location.href = url;
}

document.addEventListener("keydown", (e) => {
  if (e.key === "Escape") closeSidebar();
});
</script>

</body>
</html>
